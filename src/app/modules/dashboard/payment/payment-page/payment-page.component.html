<div>
    <ul class="flex space-x-2 rtl:space-x-reverse">
        <li>
            <a href="javascript:;" class="text-primary hover:underline">Painel</a>
        </li>
        <li class="before:content-['/'] ltr:before:mr-2 rtl:before:ml-2">
            <span>Pagamento</span>
        </li>
    </ul>
    <div class="panel mt-5 ">
        <div class="mb-5">
            <div class="grid grid-cols-1 ">

                <div class="p-8 mt-8 rounded-lg border-2 border-slate-200">
                      
                    <div *ngIf="this.statusPayment == 'TRIAL' || this.statusPayment == 'DOIS_DIAS'"  class="pricing-container">
                        <!-- Basic Plan -->
                        <div class="pricing-plan">
                            <div class="plan-content">
                                <div class="plan-name">BASIC</div>
                                <div class="plan-price">R$ 129,00</div>
                                <ul class="plan-features">
                                    
                                    <li>5 Atendentes</li>
                                    <li>Integração Whatsapp e Instagram</li>
                                    <li>Suporte por Email</li>
                                    <li>Atualizações Mensais</li>
                                </ul>
                            </div>
                            <div class="button-wrapper">
                           <button (click)="subscribe()"
                           class="select-button" data-plan="BASIC" data-plan-id="plbasic">Escolher Plano</button>
                            </div>
                        </div>
                
                        <!-- Intermediate Plan -->
                        <div class="pricing-plan intermediate">
                            <div class="popular-badge">POPULAR</div>
                            <div class="plan-content">
                                <div class="plan-name">INTERMEDIATE</div>
                                <div class="plan-price">R$ 179,90</div>
                                <ul class="plan-features">
                                    <li>12 Atendentes<li>
                                    <li>Integração Whatsapp-Instagram-Telegram-Facebook</li>                    
                                    <li>Atualizações Semanais</li>  
                                    <li>Integração e customização de API's</li>
                                </ul>
                            </div>
                            <div class="button-wrapper">
                                   <button 
                                   (click)="subscribe()"
                                   class="select-button" data-plan="INTERMEDIATE" data-plan-id="plintermediate">Escolher Plano</button>
                            </div>
                        </div>
                
                        <!-- Master Plan -->
                        <div class="pricing-plan">
                            <div class="plan-content">
                                <div class="plan-name">MASTER</div>
                                <div class="plan-price">R$ 229,90</div>
                                <ul class="plan-features">
                                    <li>Atendentes Ilimitados</li>
                                    <li>Integração Whatsapp-Instagram-Telegram-Facebook</li>                    
                                    <li>Suporte Prioritário</li>
                                    <li>Suporte 24/7</li>  
                                    <li>Integração e customização de API's</li>
                                </ul>
                            </div>
                            <div class="button-wrapper">
                                            <button class="select-button" data-plan="MASTER" data-plan-id="plmaster">Escolher Plano</button>
                            </div>
                        </div>
                    </div>
               
                    <div *ngIf="this.statusPayment != 'TRIAL' && this.statusPayment != 'DOIS_DIAS'" class="mt-8 mb-8">
              
                        <ng-datatable
                            skin="whitespace-nowrap bh-table-hover"
                            [rows]="gridRowsUser"
                            [columns]="cols"
                            [totalRows]="totalRowsUser"
                            [isServerMode]="true"
                            (changeServer)="changeServer($event)"
                            >
                            
                            <ng-template slot="subscriptionId" let-value="data">
                                <strong class="text-info">#{{ value.subscriptionId }}</strong>
                            </ng-template>
                            <ng-template slot="status	" let-value="data">
                                <span class="badge bg-{{getStatusColor(value.status)}}">
                                    {{ value.status | uppercase }}
                                </span>
                            </ng-template>
                            <ng-template slot="createdAt" let-value="data">
                                <span class="text-info">{{ value.createdAt | date:'dd/MM/yyyy HH:mm:ss' }}</span>
                            </ng-template>
                            <ng-template slot="perfil" let-value="data">
                                <span class="text-info">{{ value.perfil }}</span>
                            </ng-template> 
                            <ng-template slot="acoes" let-value="data">
                                <div class="flex items-center justify-center gap-4">
                                    <button  type="button" class="btn btn-sm btn-outline-info" (click)="openInvoiceModal(value, modalInvoiceDetails)">
                                        <icon-file/>
                                    </button>
                                    <button type="button" class="btn btn-sm btn-outline-primary" (click)="loadToEdit(value)" >
                                        <icon-edit/>
                                    </button>
                                    <button type="button" class="btn btn-sm btn-outline-danger" (click)="deleteRow(value)">
                                        <icon-trash/>
                                    </button>
                                </div>
                                
                            
                            </ng-template>
                        </ng-datatable>
                    </div>


 

                </div>

          
            </div>


        </div>
    </div>
</div>

<!-- Modal de Detalhes da Invoice -->
<ngx-custom-modal #modalInvoiceDetails class="modal-top auth-modal invoice-details-modal">
    <ng-template #modalHeader>
        <div class="!py-5">Detalhes da Invoice #{{selectedInvoice?.subscriptionId}}</div>
    </ng-template>
    
    <ng-template #modalBody>
        <div *ngIf="selectedInvoice" class="space-y-6">
            <!-- Informações principais -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-gray-50 dark:bg-gray-700 rounded">
                <div>
                    <p><strong>Status:</strong> 
                        <span class="badge bg-{{getStatusColor(selectedInvoice.status)}} ml-2">
                            {{selectedInvoice.status | uppercase}}
                        </span>
                    </p>
                    <p><strong>Criado em:</strong> {{selectedInvoice.createdAt | date:'dd/MM/yyyy HH:mm:ss'}}</p>
                </div>
                <div>
                    <p><strong>Perfil:</strong> {{selectedInvoice.perfil}}</p>
                </div>
            </div>

            <!-- Grid de Invoices -->
            <div *ngIf="selectedInvoice.invoice && selectedInvoice.invoice.length > 0">
                <h4 class="font-semibold mb-3 text-lg">Documentos Fiscais</h4>
                <div class="overflow-x-auto">
                    <table class="min-w-full bg-white dark:bg-gray-800 rounded-lg overflow-hidden">
                        <thead class="bg-gray-100 dark:bg-gray-700">
                            <tr>
                                <th class="px-4 py-3 text-left">Invoice ID</th>
                                <th class="px-4 py-3 text-left">Data</th>
                                <th class="px-4 py-3 text-left">Ações</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let inv of selectedInvoice.invoice" class="border-b border-gray-200 dark:border-gray-700">
                                <td class="px-4 py-3">
                                    <span class="font-mono text-sm">{{inv.invoiceId | slice:0:8}}...</span>
                                </td>
                                <td class="px-4 py-3">
                                    {{inv.date | date:'dd/MM/yyyy HH:mm'}}
                                </td>
                                <td class="px-4 py-3">
                                    <div class="flex space-x-2">
                                        <a [href]="inv.urlHostedInvoice" target="_blank" 
                                           class="btn btn-sm btn-outline-primary flex items-center">
                                            <icon-notes class="mr-1"/> Visualizar
                                        </a>
                                        <a [href]="inv.urlInvoicePdf" target="_blank" 
                                           class="btn btn-sm btn-outline-info flex items-center"
                                           download="invoice-{{inv.invoiceId}}.pdf">
                                            <icon-download class="mr-1"/> PDF
                                        </a>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Mensagem caso não tenha invoices -->
            <div *ngIf="!selectedInvoice.invoice || selectedInvoice.invoice.length === 0" 
                 class="p-4 bg-yellow-50 dark:bg-yellow-900 rounded text-center">
                Nenhum documento fiscal disponível
            </div>
        </div>
    </ng-template>

    <ng-template #modalFooter>
        <div class="flex justify-end">
            <button type="button" class="btn btn-outline-secondary" (click)="modalInvoiceDetails.close()">
                Fechar
            </button>
        </div>
    </ng-template>
</ngx-custom-modal>